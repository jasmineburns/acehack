<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="The blog of Saksham Sharma">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <title>AceHack - Bootloaders: Basics</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:regular,bold,italic,thin,light,bolditalic,black,medium&amp;lang=en">
    <link rel="stylesheet" href="https://code.getmdl.io/1.1.3/material.grey-pink.min.css" />
    <link rel="stylesheet" href="../css/styles.css" />
    <link rel="stylesheet" href="../css/footer.css" />

    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">

  </head>
  <body>

    <div class="mdl-layout mdl-js-layout mdl-layout--fixed-header">
        <header class="mdl-layout__header mdl-layout__header--scroll portfolio-header">
            <div class="mdl-layout__header-row portfolio-logo-row">
              <span class="mdl-layout__title">
                <a href="../">
                  <div class="portfolio-logo"></div>
                </a>
                <span class="mdl-layout__title">The blog of Saksham Sharma</span>
              </span>
            </div>
            <div class="mdl-layout__header-row portfolio-navigation-row mdl-layout--large-screen-only">
                <nav class="mdl-navigation mdl-typography--body-1-force-preferred-font">
                    <a class="mdl-navigation__link mynav" href="../index.html">Home</a>
                    <a class="mdl-navigation__link mynav" href="../archive.html">Blog</a>
                    <a class="mdl-navigation__link mynav" href="../about.html">About</a>
                </nav>
            </div>
        </header>
        <div class="mdl-layout__drawer mdl-layout--small-screen-only">
            <nav class="mdl-navigation mdl-typography--body-1-force-preferred-font">
                <a class="mdl-navigation__link mynav" href="../index.html">Home</a>
                <a class="mdl-navigation__link mynav" href="../archive.html">Blog</a>
                <a class="mdl-navigation__link mynav" href="../about.html">About</a>
            </nav>
        </div>
        <main class="mdl-layout__content">
          <div class="mdl-grid">
  <div class="mdl-cell mdl-cell--3-col"></div>
  <div class="mdl-cell mdl-cell--6-col mdl-cell--4-cell-phonemdl-card mdl-shadow--4dp">
    <div class="mdl-card__title">
      <h1 class="mdl-card__title-text" style="font-size: 2.5em;">Bootloaders: Basics</h1>
    </div>
    
    <div class="mdl-card__supporting-text">
      <strong>Written on: </strong> September  6, 2015
      <strong>by</strong> Saksham Sharma 
      <br><strong>Tags: </strong> <a href="../tags/bootloader.html">bootloader</a>, <a href="../tags/grub.html">grub</a> <br>
    </div>
    <div class="mdl-grid portfolio-copy" style="max-width: 95%;">
      <div class="mdl-cell mdl-cell--12-col mdl-cell--4-col-phone mdl-card__supporting-text no-padding">
        <p>
          <p>First things first, bootloader, what? For those who don’t know, bootloader is the piece of code which loads up your Operating System. Remember that pink screen on boot which allows you to choose between Ubuntu and Windows? Yes, that one. Its named <em>grub</em>. Remember when you booted from a pen-drive perhaps to install Ubuntu? You got a black screen allowing you to choose whether to <em>test</em> Ubuntu or to install it directly? Yes, that one. Why just Linux? The blue screen on Windows 8 (and above) PCs which appears if you want to open safe mode or something?</p>
<p>Enough examples, the job of the bootloader is to load up the ‘core’ of your OS (techies, read: Kernel), and some more things (like initial RAM disk, no don’t get confused already) which allow the operating system to start.</p>
<p>There are 2 types of booting, BIOS and UEFI, the latter being the newer one. They are considerably different, and thus, the bootloaders available vary. Most newer PCs boot via UEFI.</p>
<p>Arch Linux, like all the ‘techie’ linux distributions, requires you to manually install your bootloader. This can be very daunting, because you can run into either of the following horrible situations (yes, to scare you):</p>
<ol style="list-style-type: decimal">
<li>Instead of Windows or your default GRUB, your PC now loads up to a weird screen a command line you cannot type anything sane into.</li>
<li>You cannot boot onto your Windows installation.</li>
<li>You get a menu, but instead of opening your OS, the menu entries lead to errors.</li>
</ol>
<p>I myself have had a lot of those experiences, and I recall running to a senior once to help me ‘save’ my laptop. So it might be tricky, strap on your seatbelts.</p>
<p><strong>Syslinux</strong></p>
<p>Why is this before GRUB, you ask? You don’t need to install it on a new partition, unlike GRUB; that’s why. I had wanted to install GRUB but ending up with Syslinux during the ‘save my laptop’ time. Syslinux is a simple bootloader, which supports both BIOS and UEFI. If you have a single OS (mind this), go ahead, you won’t have any trouble. I installed it on BIOS mode, to boot my Arch, and configured my laptop to boot with Legacy mode (BIOS mode) in priority. When I wanted to boot Windows, I’d mash F12 on my keyboard (might be different for you) and selected it from the boot menu. A weird way, but had been using this since 4-5 months. Doesn’t really matter when you open Windows once a week. Again mind it, Syslinux is not for people wnating to boot multiple OS from a single bootloader.</p>
<p>First do an <code>lsblk</code>, note your boot and root partition and make sure they are mounted.</p>
<p>How to install:</p>
<pre><code>sudo pacman -S syslinux gptfdisk
sudo syslinux-install_update -i -a -m</code></pre>
<p>You need to verify (and most probably edit) the file <code>/boot/syslinux/syslinux.cfg</code>. Check to see that the root partition being mounted is correct. It defaults to /dev/sda2 but it might be different for you, correct it or else you’ll be struck at the 3rd ‘horrible situations’ as mentioned above.</p>
<p>If your root is /dev/sda3, the file should contain something like this:</p>
<pre><code>LABEL arch
        LINUX ../vmlinuz-linux
        APPEND root=/dev/sda5 rw
        INITRD ../initramfs-linux.img</code></pre>
<p>You’re good to go now, if luck is on your side.</p>
<p><strong>GRUB2</strong></p>
<p>The universal ‘go-to’ bootloader, GRUB2 is the newer version of the iconic ‘GRUB’, now renamed ‘GRUB Legacy’. It took me long enough to figure out that you cannot install GRUB2 on a ext-x partition. So if you want to install GRUB2, make a new partition and format it as vfat with <code>mkfs.vfat /dev/sdaX</code>, where ‘sdaX’ is the drive which you want to format. Don’t play around with X, identify it with <code>lsblk</code>. You’ve been warned :)</p>
<p>Once done, you need to configure your OS to mount the boot partition at it’s proper place during boots. If you are in the process of installing your OS, then you’d probably not have booted even once till now. In any case, you need to mount this /dev/sdaX at /boot of your Arch installation first. After that, in Arch, you edit the file <code>/etc/fstab</code> and write something like this there (not recommended, <em>really</em>):</p>
<pre><code>/dev/sdaX   	/boot     	vfat    	rw,relatime,fmask=0022,dmask=0022,codepage=437,iocharset=iso8859-1,shortname=mixed,errors=remount-ro	0 2</code></pre>
<p>The recommended way is to use <code>genfstab</code> while out of chroot (which you would have had been using if you’re currently installing your arch). That would automatically create your fstab according to the currently used mount pattern. Double check it.</p>
<p>Installing the required packages is the next step:</p>
<pre><code>sudo pacman -S grub efibootmgr os-prober</code></pre>
<p>Now following the Arch Wiki, we do this:</p>
<pre><code>grub-install --target=x86_64-efi --efi-directory=/boot --bootloader-id=grub --recheck
grub-mkconfig -o /boot/grub/grub.cfg</code></pre>
<p>And there! You’re probably done! If you run a normal PC (that is, no archaic stuff or some really non-obvious choice of partitions or configurations which might require some more work). Luckily, the Arch wiki is there to help in such cases.</p>
<p>Feel free to comment if you run into a mountain.</p>
        </p>
      </div>
    </div>
  </div>
</div>

            <footer class="mdl-mini-footer">
                <div class="mdl-mini-footer__left-section">
                  <div class="mdl-logo">
                    <h5 style="color: #bbbbbb; margin: 0; padding: 0;">AceHack</h5>
                    <p style="color: #aaaaaa; margin: 0; margin-top: 5px; padding: 0;">The blog of Saksham Sharma</p>
                    <p style="color: #aaaaaa; margin: 0; margin-top: 5px; padding: 0;">Hosted on Github <a href="https://github.com/sakshamsharma/sakshamsharma.github.io" target="_blank">here</a><p>
                  </div>
                </div>
                <div class="mdl-mini-footer__middle-section">
                  <div class="mdl-logo">
                    <a href="https://github.com/sakshamsharma" target="_blank">sakshamsharma</a>@github<br>
                    <a href="mailto:saksham@acehack.org" target="_blank">saksham@acehack.com</a>
                  </div>
                </div>
                <div class="mdl-mini-footer__right-section">
                  <div class="mdl-logo">Proudly generated by Hakyll</div>
                </div>
            </footer>
        </main>
    </div>
    <script src="https://code.getmdl.io/1.1.3/material.min.js"></script>
    <script>
     var links = document.getElementsByClassName('mynav');
     for(i=0;i<links.length;i++) {
       var tmp = links[i].href;
       if (tmp.substring(tmp.lastIndexOf('/')) == document.location.pathname) {
         links[i].className += " is-active"
       }
     }
    </script>
  </body>
</html>
